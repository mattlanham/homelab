apiVersion: v1
kind: ConfigMap
metadata:
  name: homeassistant-config
  namespace: homeassistant
data:
  configuration.yaml: |
    # Configure a default setup of Home Assistant (frontend, api, etc)
    default_config:

    # HTTP Configuration for reverse proxy
    http:
      use_x_forwarded_for: true
      trusted_proxies:
        - 10.42.1.10  # Specific proxy IP from error
        - 10.0.0.0/8  # All private IPs in this range
        - '*'  # Trust all proxies since we're behind Cloudflare
      ip_ban_enabled: false
      server_host: 0.0.0.0
      use_x_forwarded_host: true

    # Evohome Integration
    evohome:
      username: !secret evohome_username
      password: !secret evohome_password
      location_idx: 0  # Optional, defaults to 0.
      scan_interval: 300  # Optional, defaults to 300 seconds.

    # Load secrets from secrets.yaml
    secrets: !include secrets.yaml 